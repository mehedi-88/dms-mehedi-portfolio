/* =========================
   DMS Chat Widget — Clean CSS
   ========================= */

/* Root */
.dms-chat{
  position:fixed; right:22px; bottom:22px; z-index:9999;
  font-family:Inter,system-ui,Segoe UI,Roboto,sans-serif;
}

/* ---------- FAB ---------- */
.dms-chat__fab{
  width:60px;height:60px;border-radius:50%;
  border:none;cursor:pointer;color:#fff;
  background:linear-gradient(135deg,#4f46e5,#6366f1,#8b5cf6);
  box-shadow:0 10px 28px rgba(99,102,241,.4);
  display:grid;place-items:center;
  transition:transform .25s ease,box-shadow .3s ease;
  animation:fabGlow 3s infinite ease-in-out;
}
.dms-chat__fab:hover{ transform:scale(1.07); box-shadow:0 16px 40px rgba(99,102,241,.5); }

@keyframes fabGlow{
  0%,100%{box-shadow:0 0 0 rgba(99,102,241,0)}
  50%{box-shadow:0 0 18px rgba(99,102,241,.5)}
}

/* ---------- Quick pills (translucent) ---------- */
.dms-quick__pill{
  border:1px solid rgba(148,163,184,.45)!important;
  background:rgba(255,255,255,.5)!important;
  backdrop-filter: blur(6px);
  border-radius:999px;
}

/* ---------- Message status ticks ---------- */
.dms-chat__bubble[data-status="sent"]::after{
  content:" ✓"; margin-left:6px; font-size:.92em; color:#9ca3af;
}
.dms-chat__bubble.is-online[data-status="sent"]::after{
  content:" ✓✓"; color:#10b981; font-weight:800;
}
.dms-chat__bubble[data-status="seen"]::after{
  content:" ✓✓"; margin-left:6px; font-size:.92em; color:#22c55e; font-weight:800;
}

/* ---------- Scrollbar (nice but subtle) ---------- */
.msgs::-webkit-scrollbar, .list::-webkit-scrollbar{ width:10px }
.msgs::-webkit-scrollbar-thumb, .list::-webkit-scrollbar-thumb{ background:#1f2937; border-radius:999px }
.msgs::-webkit-scrollbar-track, .list::-webkit-scrollbar-track{ background:transparent }

/* ---------- Admin online pulse (FAB + badge) ---------- */
.dms-chat.admin-online .dms-chat__fab{
  animation:fabGlow 3.2s ease-in-out infinite, fabPulse 2.2s ease-in-out infinite;
}
@keyframes fabPulse{
  0%{box-shadow:0 0 0 0 rgba(34,197,94,.5)}
  70%{box-shadow:0 0 0 16px rgba(34,197,94,0)}
  100%{box-shadow:0 0 0 0 rgba(34,197,94,0)}
}
.dms-chat__badge.is-admin{
  color:#166534; background:#dcfce7; border-color:#86efac;
  box-shadow:0 0 0 0 rgba(34,197,94,.45);
  animation:badgePulse 2.4s ease-in-out infinite;
}
@keyframes badgePulse{ 0%{filter:brightness(1)} 50%{filter:brightness(1.12)} 100%{filter:brightness(1)} }

/* ---------- Teaser badge ---------- */
.dms-teaser .badge{
  min-width:20px; height:20px; padding:0 6px; border-radius:999px;
  background:#ef4444; color:#fff; font-weight:800; font-size:12px;
  display:inline-flex; align-items:center; justify-content:center;
}

/* ---------- Bubbles border (slender) ---------- */
.dms-chat__bubble{ border:1px solid rgba(0,0,0,.06); }

/* ---------- Teaser bubble (glass) ---------- */
.dms-teaser{
  position:absolute; right:70px; bottom:6px;
  background:rgba(15,23,42,.45);  /* translucent */
  color:#e2e8f0;
  border:1px solid rgba(148,163,184,.25);
  border-radius:999px;
  padding:.5rem .8rem;
  display:flex; gap:8px; align-items:center;
  box-shadow:0 10px 24px rgba(0,0,0,.25);
  backdrop-filter: blur(10px);
  opacity:0; transform:translateX(8px);
  pointer-events:none; transition:all .25s ease;
}
.dms-teaser.show{opacity:1; transform:none; pointer-events:auto}
.dms-teaser .dot{width:8px;height:8px;border-radius:999px;background:#22c55e;box-shadow:0 0 10px rgba(34,197,94,.6)}
.dms-teaser .kbd{font-size:11px;background:rgba(17,24,39,.6);border:1px solid rgba(51,65,85,.6);padding:2px 6px;border-radius:6px;color:#cbd5e1}

/* ---------- Quick replies (glass) ---------- */
.dms-quick{
  display:flex;flex-wrap:wrap;gap:8px;padding:8px 12px;
  border-top:1px solid rgba(226,232,240,.6); background:rgba(255,255,255,.65);
  backdrop-filter: blur(8px);
}
.dms-quick__pill{
  border:1px solid rgba(209,213,219,.7);
  background:rgba(255,255,255,.55);
  backdrop-filter: blur(6px);
  border-radius:999px; padding:.35rem .7rem; font-size:13px; cursor:pointer;
}
.dms-quick__pill:hover{ background:rgba(241,245,249,.75) }

/* ---------- Panel ---------- */
.dms-chat__panel{
  position:absolute; right:0; bottom:75px; width:min(380px,94vw);
  background:rgba(255,255,255,.96); backdrop-filter:blur(18px);
  border-radius:18px; border:1px solid rgba(0,0,0,.08);
  box-shadow:0 24px 64px rgba(0,0,0,.25);
  display:flex; flex-direction:column; overflow:hidden;
  opacity:0; transform:translateY(15px) scale(.96); transition:all .3s ease;
}
.dms-chat__panel[hidden]{display:flex;visibility:hidden}
.dms-chat__panel:not([hidden]){opacity:1;transform:translateY(0) scale(1);visibility:visible}

/* ---------- Header ---------- */
.dms-chat__head{
  display:flex;align-items:center;justify-content:space-between;
  padding:14px 16px;background:linear-gradient(135deg,#0f172a,#1e293b);color:#f1f5f9
}
.dms-chat__brand{font-weight:800;font-size:15px;color:#fff}
.dms-chat__badge{font-size:12px;font-weight:600;color:#4f46e5;background:#eef2ff;border:1px solid #c7d2fe;padding:.22rem .55rem;border-radius:999px;transition:all .3s ease}
.dms-chat__close{background:transparent;border:none;font-size:22px;cursor:pointer;color:#cbd5e1;transition:.2s}
.dms-chat__close:hover{color:#fff;transform:rotate(90deg)}

/* ---------- Messages ---------- */
.dms-chat__msgs{
  height:360px;overflow-y:auto;padding:14px;display:flex;flex-direction:column;gap:10px;background:#f8fafc;scroll-behavior:smooth
}
.dms-chat__msgs::-webkit-scrollbar{width:6px}
.dms-chat__msgs::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:999px}

/* ---------- Bubbles ---------- */
.dms-chat__bubble{
  max-width:78%;padding:.65rem .85rem;border-radius:16px;font-size:14px;line-height:1.5;border:1px solid rgba(0,0,0,.06);word-break:break-word;white-space:pre-wrap;animation:fadeInUp .25s ease both
}
.dms-chat__bubble--user{align-self:flex-end;background:linear-gradient(135deg,#eef2ff,#e0e7ff);border-color:#c7d2fe;color:#111827}
.dms-chat__bubble--agent{align-self:flex-start;background:#fff;color:#0f172a;border-color:#e2e8f0}
@keyframes fadeInUp{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

/* ---------- Composer ---------- */
.dms-chat__composer{display:flex;gap:10px;padding:12px;border-top:1px solid #e5e7eb;background:#fff}
#dms-input{
  flex:1;min-height:44px;max-height:130px;padding:.65rem .8rem;border-radius:12px;border:1px solid #d1d5db;outline:none;resize:none;font-size:14px;line-height:1.4;transition:border .2s,box-shadow .2s
}
#dms-input:focus{border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.25)}
.dms-chat__send{background:linear-gradient(135deg,#4f46e5,#6366f1);border:none;color:#fff;font-weight:700;padding:.65rem 1.1rem;border-radius:12px;cursor:pointer;transition:transform .2s}
.dms-chat__send:hover{transform:scale(1.05)}

/* ---------- Caret for typewriter ---------- */
.dms-caret::after{
  content:"";display:inline-block;width:6px;height:14px;margin-left:2px;background:#6366f1;border-radius:2px;animation:blink .9s infinite
}
@keyframes blink{0%,50%{opacity:1}51%,100%{opacity:0}}

/* ---------- Typing indicator (Widget) ---------- */
/* একটাই রো রাখা হবে — JS show()/hide() করবে */
#dms-msgs .dms-typing{
  display:none;               /* .show দিলে flex হবে */
  align-items:center; gap:6px; margin:6px 2px 8px;
  color:#667eea; font-size:13px;
}
#dms-msgs .dms-typing.show{ display:flex; }

#dms-msgs .dms-typing .label{ font-weight:600; opacity:.85; }
#dms-msgs .dms-typing .dots{ display:inline-flex; align-items:center; justify-content:center; margin-left:4px; }
#dms-msgs .dms-typing .dot{
  width:8px;height:8px;border-radius:999px;background:#667eea; opacity:.25;
  animation:dmsTypingDot 1.05s infinite ease-in-out;
}
#dms-msgs .dms-typing .dot:nth-child(2){ animation-delay:.18s; }
#dms-msgs .dms-typing .dot:nth-child(3){ animation-delay:.36s; }

@keyframes dmsTypingDot {
  0%, 80%, 100% { transform:translateY(0); opacity:.25; }
  40%          { transform:translateY(-5px); opacity:1; }
}

/* ---------- Teaser (pill near FAB) ---------- */
.dms-teaser{
  position: fixed; right: 86px; bottom: 20px;
  display: inline-flex; align-items: center; gap: 10px;
  padding: 10px 14px; border-radius: 999px;
  background: rgba(33, 46, 74, 0.88); color:#e5e7eb; border:1px solid #334155;
  backdrop-filter: blur(6px); cursor:pointer; opacity:0; transform:translateY(10px);
  transition: .35s ease; z-index: 2147483000;
}
.dms-teaser.show{ opacity:1; transform:translateY(0); }
.dms-teaser .dot{ width:8px; height:8px; border-radius:999px; background:#22c55e; box-shadow:0 0 10px rgba(34,197,94,.5); }
.dms-teaser .txt{ font-weight:700; letter-spacing:.2px; }
.dms-teaser .badge{
  min-width:20px; height:20px; padding:0 6px; border-radius:999px;
  background:#ef4444; color:#fff; font-weight:800; font-size:12px;
  display:inline-flex; align-items:center; justify-content:center;
}

/* ---------- Teaser hover preview ---------- */
.dms-teaser__preview{
  position: fixed; right: 86px; bottom: 64px;
  max-width: 240px; background:#222630; color:#e5e7eb;
  border:1px solid #3e444d; border-radius:10px; padding:8px 10px;
  box-shadow:0 8px 28px rgba(0,0,0,.35); z-index:2147483000;
}

/* ---------- Responsive ---------- */
@media (max-width: 1024px){
  .dms-chat__panel{ width:min(420px,96vw); }
}
@media (max-width: 640px){
  .dms-chat { right: 14px; bottom: 14px; }
  .dms-chat__fab{ width:54px;height:54px; }
  .dms-chat__panel{
    position: fixed; right: 0; left: 0; bottom: 0; width: 100vw;
    height: calc(var(--vh, 1vh) * 100 - 8px); max-height: none;
    border-radius: 18px 18px 0 0; transform: translateY(10px);
  }
  .dms-chat__msgs{ height: calc(100% - 126px); }
  .dms-teaser{ right: 70px; bottom: 78px; font-size:13px; }
}

/* ---------- iOS safe-area ---------- */
@supports (padding: env(safe-area-inset-bottom)){
  .dms-chat__panel{ padding-bottom: env(safe-area-inset-bottom); }
  .dms-chat__composer{ padding-bottom: calc(12px + env(safe-area-inset-bottom)); }
}

/* =======================
 
  
  /* row that JS toggles */
  .dms-typing{
    display:none;
    align-items:center;
    gap:.6rem;
    margin:.35rem 0;
    padding:.55rem .7rem;
    border-radius:14px;
    background:var(--ti-bg);
    -webkit-backdrop-filter: blur(8px);
    backdrop-filter: blur(8px);
    color:var(--ti-text);
    font-size:.85rem;
    line-height:1.15;
    max-width:min(78%, 520px);
    transition:opacity .18s ease, transform .18s ease;
    opacity:0; transform:translateY(2px);
  }
  .dms-typing.show{ display:flex; opacity:1; transform:translateY(0); }

  
/* inline typing indicator — no bubble box */
.dms-typing-bubble,
.dms-typing-bubble.dms-chat__bubble,
.dms-typing-bubble.dms-chat__bubble--agent {
  background: transparent !important;
  border: 0 !important;
  box-shadow: none !important;
  padding: 0 !important;
  margin: 6px 8px !important;
  max-width: none !important;
  display: inline-flex !important;
  align-items: center;
}

/* text */
.dms-typing-bubble .label {
  font-size: 13px;
  line-height: 1;
  color: #5f6b7a;   /* হালকা গ্রে */
  margin-right: 8px;
}

/* dots row */
.dms-typing-bubble .dots {
  display: inline-flex;
  gap: 6px;
  align-items: center;
}

/* bouncing dots */
.dms-typing-bubble .dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #8594a5;
  opacity: .55;
  transform-origin: center bottom;
  animation: dmsDotBounce 1.2s infinite ease-in-out;
}
.dms-typing-bubble .dot:nth-child(2) { animation-delay: .12s }
.dms-typing-bubble .dot:nth-child(3) { animation-delay: .24s }

@keyframes dmsDotBounce {
  0%, 80%, 100% { transform: translateY(0) scale(1); opacity:.45; }
  30%          { transform: translateY(-5px) scale(1.05); opacity:.9; }
}